import { Metadata } from 'next';\nimport { getServerSession } from 'next-auth';\nimport { authOptions } from '@/lib/auth';\nimport { prisma } from '@awcrm/database';\nimport { redirect } from 'next/navigation';\nimport { SecurityDashboard } from '@/components/security/security-dashboard';\n\nexport const metadata: Metadata = {\n  title: 'Security Dashboard',\n  description: 'Monitor security events and manage security settings',\n};\n\nasync function checkSecurityAccess() {\n  const session = await getServerSession(authOptions);\n  \n  if (!session?.user?.id) {\n    return null;\n  }\n  \n  const user = await prisma.user.findUnique({\n    where: { id: session.user.id },\n    select: { role: true, organizationId: true },\n  });\n  \n  return user;\n}\n\nexport default async function SecurityPage() {\n  const user = await checkSecurityAccess();\n  \n  if (!user) {\n    redirect('/auth/login');\n  }\n  \n  // Only admins and managers can access security dashboard\n  if (user.role !== 'ADMIN' && user.role !== 'MANAGER') {\n    redirect('/dashboard');\n  }\n  \n  return <SecurityDashboard />;\n}\n"